[pool-4-thread-1] ERROR org.springframework.scheduling.support.TaskUtils$LoggingErrorHandler - Unexpected error occurred in scheduled task.
org.springframework.dao.DataAccessResourceFailureException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.
### The error may exist in URL [jar:file:/C:/project/new/macao/web/webapp/WEB-INF/lib/common-1.0-SNAPSHOT.jar!/mybatis/mapping/SpcarOrderMapper.xml]
### The error may involve com.yinghai.macao.common.dao.SpcarOrderMapper.findListPage
### The error occurred while executing a query
### SQL: select       o.spcar_order_id,o.order_id, o.monthly,o.comment,o.order_no , o.status , o.driver_id , o.passenger_id , o.spcar_id ,o.confirm_id , o.confirm_type ,o.cancel_time,o.reject_id AS o_reject_id,o.refund_money,         o.reject_type , o.memo, o.start_x , o.start_y , o.start_address , o.update_time, o.create_time , o.pay_time ,o.driver_arrive_time,o.driver_setout_time,o.passenger_arrive_time,o.complete_time,         o.amount , o.pay_status , o.total_hour, o.start_time , o.cancel_type, o.pay_way , o.pay_way_code , o.end_x ,   o.end_y , o.end_address ,c.spcar_id AS c_spcar_id,         c.spcar_type AS c_spcar_type, c.spcar_color AS c_spcar_color, c.spcar_no AS c_spcar_no, c.spcar_sit AS c_spcar_sit, c.spcar_used AS c_spcar_used, c.create_time AS c_create_tme,         c.update_time AS c_update_time, p.spcar_id  AS spcar_passenger_id,          p.name AS p_name, p.vip AS p_vip,p.family_name AS p_family_name, p.given_name AS p_given_name, p.country_code AS p_country_code, p.tel AS p_tel, p.loc_x AS p_loc_x, p.loc_y AS p_loc_y, p.last_login AS p_last_login,      p.create_time AS p_create_tme, p.device_id AS p_device_id, p.passenger_id AS p_passenger_id,          p.status AS p_status, p.sex AS p_sex, p.order_count AS p_order_count, p.cancel_count AS p_cancel_count, p.finish_count AS p_finish_count,  p.title,    p.deleted AS p_deleted,p.rating AS p_rating, p.device_type AS p_device_type, p.im_name AS p_im_name, p.sign AS p_sign,p.verification AS p_verification,d.spcar_driver_id AS spcar_driver_id,          d.name AS d_name, d.loc_x AS d_loc_x, d.loc_y AS d_loc_Y, d.status AS d_status, d.license, d.image, d.driver_type, d.spcar_type AS d_spcar_type,      d.create_time AS d_create_tme, d.last_update, d.device_id  AS d_device_id, d.verification  AS d_verification,          d.country_code AS d_country_code, d.tel AS d_tel,d.country_code2 AS d_country_code2, d.tel2 AS d_tel2, d.given_name AS d_given_name,      d.family_name AS d_family_name, d.userId AS d_userId, d.rating AS d_rating, d.english_capability AS d_english_capability, d.profile_image AS d_profile_image, d.order_count AS d_order_count, d.cancel_count AS d_cancel_count,      d.finish_count AS d_finish_count,           d.deleted AS d_deleted, d.license_true AS d_license_true, d.license_till AS d_license_till, d.shift AS d_shift, d.device_type AS d_device_type,d.im_name as d_im_name      from spcar_order o LEFT JOIN spcar c ON o.spcar_id=c.spcar_id LEFT JOIN spcar_passenger p ON o.passenger_id=p.spcar_id LEFT JOIN spcar_driver d ON o.driver_id=d.spcar_driver_id   where 1=1                                                               and o.`status` in        (                ?              )                    order by FIELD(o.`status`,2,3,6,4,0,5,999,998,997),o.spcar_order_id desc
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.
; SQL []; No operations allowed after connection closed.; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:79)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:73)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:371)
	at com.sun.proxy.$Proxy129.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:198)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:119)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:63)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:52)
	at com.sun.proxy.$Proxy138.findListPage(Unknown Source)
	at com.yinghai.macao.common.service.impl.SpcarOrderServiceImpl.findList(SpcarOrderServiceImpl.java:952)
	at com.yinghai.macao.common.service.impl.SpcarOrderServiceImpl$$FastClassBySpringCGLIB$$922089e7.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:651)
	at com.yinghai.macao.common.service.impl.SpcarOrderServiceImpl$$EnhancerBySpringCGLIB$$d1890130.findList(<generated>)
	at com.yinghai.macao.common.job.SpcarOrderTask.sendMsgToSpcarPassenger(SpcarOrderTask.java:39)
	at sun.reflect.GeneratedMethodAccessor511.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:65)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
	at com.mysql.jdbc.Util.getInstance(Util.java:386)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1015)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:989)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:975)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:920)
	at com.mysql.jdbc.ConnectionImpl.throwConnectionClosedException(ConnectionImpl.java:1320)
	at com.mysql.jdbc.ConnectionImpl.checkClosed(ConnectionImpl.java:1312)
	at com.mysql.jdbc.ConnectionImpl.prepareStatement(ConnectionImpl.java:4547)
	at com.mysql.jdbc.ConnectionImpl.prepareStatement(ConnectionImpl.java:4512)
	at org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:248)
	at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:302)
	at sun.reflect.GeneratedMethodAccessor164.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:54)
	at com.sun.proxy.$Proxy47.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:75)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:85)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:57)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:73)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:59)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:267)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:137)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:96)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:77)
	at sun.reflect.GeneratedMethodAccessor513.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49)
	at com.yinghai.macao.common.util.PageHelper.intercept(PageHelper.java:108)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:60)
	at com.sun.proxy.$Proxy157.query(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:108)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:102)
	at sun.reflect.GeneratedMethodAccessor512.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:358)
	... 25 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet successfully received from the server was 10,146 milliseconds ago.  The last packet sent successfully to the server was 10,148 milliseconds ago.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
	at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1129)
	at com.mysql.jdbc.MysqlIO.send(MysqlIO.java:3988)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2598)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2778)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2828)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2777)
	at com.mysql.jdbc.StatementImpl.executeQuery(StatementImpl.java:1651)
	at com.mysql.jdbc.DatabaseMetaData.getUserName(DatabaseMetaData.java:7006)
	at org.apache.commons.dbcp.DelegatingConnection.toString(DelegatingConnection.java:104)
	at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.toString(PoolingDataSource.java:344)
	at java.lang.String.valueOf(String.java:2994)
	at java.lang.StringBuilder.append(StringBuilder.java:131)
	at org.mybatis.spring.transaction.SpringManagedTransaction.openConnection(SpringManagedTransaction.java:86)
	at org.mybatis.spring.transaction.SpringManagedTransaction.getConnection(SpringManagedTransaction.java:67)
	at org.apache.ibatis.executor.BaseExecutor.getConnection(BaseExecutor.java:279)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:72)
	... 43 more
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:109)
	at java.net.SocketOutputStream.write(SocketOutputStream.java:153)
	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
	at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140)
	at com.mysql.jdbc.MysqlIO.send(MysqlIO.java:3969)
	... 57 more
